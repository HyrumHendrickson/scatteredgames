<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Platformer Game with Camera Tracking</title>
    <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    .game-container {
        width: 800px;
        margin: 20px auto;
    }

    .game-info {
        display: flex;
        justify-content: space-between;
        padding: 10px;
        background-color: #333;
        border-radius: 5px 5px 0 0;
        font-size: 18px;
        position: relative;
        z-index: 10;
    }

    #game {
        position: relative;
        width: 800px;
        height: 500px;
        background-color: #87CEEB;
        overflow: hidden;
        border: 2px solid #444;
    }
    
    #game-world {
        position: absolute;
        width: 3000px;
        height: 2000px;
        background: linear-gradient(to bottom, #1E90FF, #87CEEB);
    }

    #player {
        position: absolute;
        width: 40px;
        height: 40px;
        background-color: #FF5252;
        border-radius: 15px 5px 5px 5px;
        transition: border-radius 0.1s, height 0.2s, margin-top 0.2s;
        box-shadow: 0 3px 5px rgba(0, 0, 0, 0.3);
        z-index: 5;
    }

    .platform {
        position: absolute;
        background: linear-gradient(to bottom, #8BC34A, #689F38);
        border-top: 3px solid #8BC34A;
        border-radius: 4px;
        box-shadow: 0 3px 5px rgba(0, 0, 0, 0.3);
    }

    .coin {
        position: absolute;
        width: 20px;
        height: 20px;
        background-color: gold;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        z-index: 3;
    }
    
    .special-coin {
        width: 25px !important;
        height: 25px !important;
        background-color: #FFD700 !important;
        box-shadow: 0 0 10px 5px rgba(255, 215, 0, 0.5);
        animation: specialSpin 1.5s linear infinite;
    }

    .enemy {
        position: absolute;
        width: 30px;
        height: 30px;
        background-color: #9C27B0;
        border-radius: 50%;
        z-index: 4;
    }

    .controls {
        margin-top: 20px;
        background-color: #333;
        padding: 10px;
        border-radius: 5px;
        text-align: center;
    }

    @keyframes spin {
        0% { transform: scale(1); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }
    
    @keyframes specialSpin {
        0% { transform: scale(1) rotate(0deg); }
        50% { transform: scale(1.3) rotate(180deg); }
        100% { transform: scale(1) rotate(360deg); }
    }
    </style>
    <link rel="stylesheet" href="style.css">
    <style>

.big-box {
        font-family: 'Arial', sans-serif;
        background-color: #222;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        color: white;
    }


        
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <h1 class="logo">ScatteredGames</h1>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="platform.html">Platformer</a></li>
                <li><a href="space.html">Asteroid</a></li>
                <li><a href="life.html">Game of Life</a></li>
                <li><a href="math.html">Math Game</a></li>
            </ul>
        </div>
    </nav>
    <div class="big-box">
    <div class="game-container">
        <div class="game-info">
            <div class="score">Score: <span id="score">0</span></div>
            <div class="lives">Lives: <span id="lives">3</span></div>
        </div>
        <div id="game">
            <!-- Game world and elements will be created by JavaScript -->
        </div>
    </div>

    <div class="controls">
        <p>Controls: Use ← → arrow keys to move, Space to jump</p>
    </div>
    </div>
    <footer>
        <p>&copy; 2025 ScatteredGames. All rights reserved.</p>
    </footer>
    <script>
    // Game configuration
    const config = {
        gravity: 0.6,
        playerSpeed: 0.8,
        maxSpeed: 8,
        jumpForce: 15,
        friction: 0.92,
        airControl: 0.5,
        coinCount: 20,
        enemyCount: 10,
        coyoteTime: 100,
        jumpBufferTime: 150,
        worldWidth: 3000,
        worldHeight: 2000,
        viewportWidth: 800,
        viewportHeight: 500
    };

    // Game state
    const game = {
        score: 0,
        lives: 3,
        isGameOver: false,
        camera: {
            x: 0,
            y: 0,
            targetX: 0,
            targetY: 0
        }
    };

    // Player object
    const player = {
        element: null, // Will be set after DOM creation
        x: 150,
        y: 1500,
        width: 40,
        height: 40,
        velocityX: 0,
        velocityY: 0,
        isJumping: false,
        isMovingLeft: false,
        isMovingRight: false,
        lastOnGround: 0,
        jumpBuffered: false,
        jumpBufferTimestamp: 0,
        facingDirection: 1
    };

    // Arrays to store game objects
    const platforms = [];
    const coins = [];
    const enemies = [];

    // Initialize game
    function init() {
        // Create game world
        const gameWorld = document.createElement('div');
        gameWorld.id = 'game-world';
        gameWorld.style.position = 'absolute';
        gameWorld.style.width = config.worldWidth + 'px';
        gameWorld.style.height = config.worldHeight + 'px';
        document.getElementById('game').appendChild(gameWorld);
        
        // Create player element
        const playerElement = document.createElement('div');
        playerElement.id = 'player';
        gameWorld.appendChild(playerElement);
        player.element = playerElement;
        
        // Set player initial position
        updatePlayerPosition();
        
        // Create the fixed map
        createMap();
        
        // Create game objects
        createGameObjects();
        
        // Start game loop
        gameLoop();
        
        // Event listeners for player controls
        document.addEventListener('keydown', handleKeyDown);
        document.addEventListener('keyup', handleKeyUp);
    }

    // Create a fixed map instead of random platforms
    function createMap() {
        // Ground platforms
        createPlatform(-50, 1800, 3100, 200); // Main ground floor
        
        // Left area - starting zone
        createPlatform(100, 1600, 200, 20);
        createPlatform(400, 1500, 150, 20);
        createPlatform(200, 1350, 180, 20);
        createPlatform(500, 1250, 220, 20);
        createPlatform(300, 1100, 150, 20);
        
        // Middle area - central structures
        createPlatform(800, 1700, 400, 20);
        createPlatform(900, 1550, 200, 20);
        createPlatform(750, 1400, 300, 20);
        createPlatform(1000, 1250, 350, 20);
        createPlatform(850, 1100, 250, 20);
        createPlatform(950, 950, 200, 20);
        createPlatform(1100, 800, 400, 20);
        
        // Right area - advanced platforming challenges
        createPlatform(1600, 1700, 180, 20);
        createPlatform(1900, 1650, 150, 20);
        createPlatform(2200, 1700, 200, 20);
        createPlatform(1700, 1500, 120, 20);
        createPlatform(2000, 1450, 100, 20);
        createPlatform(2300, 1500, 150, 20);
        createPlatform(1800, 1300, 130, 20);
        createPlatform(2100, 1250, 110, 20);
        createPlatform(2400, 1300, 160, 20);
        
        // Upper area - harder to reach platforms
        createPlatform(700, 700, 200, 20);
        createPlatform(1000, 600, 150, 20);
        createPlatform(1300, 650, 180, 20);
        createPlatform(1600, 600, 200, 20);
        createPlatform(1900, 550, 150, 20);
        createPlatform(2200, 600, 180, 20);
        
        // Top area - highest platforms
        createPlatform(800, 400, 130, 20);
        createPlatform(1100, 350, 100, 20);
        createPlatform(1400, 300, 160, 20);
        createPlatform(1700, 250, 180, 20);
        createPlatform(2000, 300, 150, 20);
        
        // Secret area
        createPlatform(2400, 200, 300, 20);
        createPlatform(2600, 100, 200, 20);
    }

    // Create coins and enemies in fixed positions
    function createGameObjects() {
        // Create coins in specific positions
        createCoin(150, 1550);
        createCoin(450, 1450);
        createCoin(250, 1300);
        createCoin(550, 1200);
        createCoin(350, 1050);
        
        createCoin(850, 1650);
        createCoin(950, 1500);
        createCoin(800, 1350);
        createCoin(1050, 1200);
        createCoin(900, 1050);
        createCoin(1000, 900);
        createCoin(1150, 750);
        
        createCoin(1650, 1650);
        createCoin(1950, 1600);
        createCoin(1750, 1450);
        createCoin(2050, 1400);
        createCoin(1850, 1250);
        createCoin(2150, 1200);
        
        createCoin(750, 650);
        createCoin(1050, 550);
        createCoin(1350, 600);
        createCoin(1650, 550);
        
        // Special high-value coins in hard-to-reach areas
        createSpecialCoin(1150, 300);
        createSpecialCoin(1750, 200);
        createSpecialCoin(2650, 50);
        
        // Create enemies in specific positions with specific behaviors
        createEnemy(600, 1750, 1, 1.5);  // Ground patrol
        createEnemy(1200, 1650, -1, 2);  // Platform patrol
        createEnemy(1400, 1200, 1, 2.5); // Platform patrol
        createEnemy(1850, 1600, -1, 1);  // Platform patrol
        createEnemy(2000, 1400, 1, 1.8); // Platform patrol
        createEnemy(1300, 600, -1, 1.5); // High platform patrol
        createEnemy(1850, 500, 1, 2);    // High platform patrol
        createEnemy(1000, 500, -1, 1);   // High platform patrol
    }

    // Create a single platform
    function createPlatform(x, y, width, height) {
        const platform = document.createElement('div');
        platform.className = 'platform';
        platform.style.left = x + 'px';
        platform.style.top = y + 'px';
        platform.style.width = width + 'px';
        platform.style.height = height + 'px';
        
        const gameElement = document.getElementById('game-world');
        gameElement.appendChild(platform);
        
        platforms.push({
            element: platform,
            x,
            y,
            width,
            height
        });
    }

    // Create a single coin
    function createCoin(x, y) {
        const coin = document.createElement('div');
        coin.className = 'coin';
        coin.style.left = x + 'px';
        coin.style.top = y + 'px';
        
        const gameElement = document.getElementById('game-world');
        gameElement.appendChild(coin);
        
        coins.push({
            element: coin,
            x,
            y,
            width: 20,
            height: 20,
            collected: false,
            special: false
        });
    }
    
    // Create a special high-value coin
    function createSpecialCoin(x, y) {
        const coin = document.createElement('div');
        coin.className = 'coin special-coin';
        coin.style.left = x + 'px';
        coin.style.top = y + 'px';
        
        const gameElement = document.getElementById('game-world');
        gameElement.appendChild(coin);
        
        coins.push({
            element: coin,
            x,
            y,
            width: 25,
            height: 25,
            collected: false,
            special: true
        });
    }

    // Create a single enemy
    function createEnemy(x, y, direction, speed) {
        const enemy = document.createElement('div');
        enemy.className = 'enemy';
        enemy.style.left = x + 'px';
        enemy.style.top = y + 'px';
        
        const gameElement = document.getElementById('game-world');
        gameElement.appendChild(enemy);
        
        enemies.push({
            element: enemy,
            x,
            y,
            width: 30,
            height: 30,
            direction,
            speed,
            initialX: x // Store initial position for patrol behavior
        });
    }

    // Handle keydown events
    function handleKeyDown(e) {
        if (game.isGameOver) return;
        
        if (e.key === 'ArrowLeft' || e.key === 'a') {
            player.isMovingLeft = true;
            player.facingDirection = -1;
        }
        if (e.key === 'ArrowRight' || e.key === 'd') {
            player.isMovingRight = true;
            player.facingDirection = 1;
        }
        if (e.key === 'ArrowUp' || e.key === 'w' || e.key === ' ') {
            // If we can jump immediately, do so
            if (!player.isJumping && (Date.now() - player.lastOnGround < config.coyoteTime)) {
                jump();
            } else {
                // Otherwise, buffer the jump
                player.jumpBuffered = true;
                player.jumpBufferTimestamp = Date.now();
            }
        }
    }

    // Handle keyup events
    function handleKeyUp(e) {
        if (e.key === 'ArrowLeft' || e.key === 'a') {
            player.isMovingLeft = false;
        }
        if (e.key === 'ArrowRight' || e.key === 'd') {
            player.isMovingRight = false;
        }
    }

    // Player jump function
    function jump() {
        // Add a small vertical impulse before the jump for better feel
        player.y -= 3;
        player.velocityY = -config.jumpForce;
        player.isJumping = true;
        player.jumpBuffered = false;
        
        // Add a small speed boost in the direction of movement for better control
        if (player.isMovingRight) {
            player.velocityX += 2;
        } else if (player.isMovingLeft) {
            player.velocityX -= 2;
        }
    }

    // Update player position and appearance
    function updatePlayerPosition() {
        player.element.style.left = player.x + 'px';
        player.element.style.top = player.y + 'px';
        
        // Visual feedback for movement direction
        if (player.facingDirection === -1) {
            player.element.style.borderRadius = '5px 15px 5px 5px';
        } else {
            player.element.style.borderRadius = '15px 5px 5px 5px';
        }
        
        // Visual feedback for jumping
        if (player.isJumping) {
            player.element.style.height = '35px';
            player.element.style.marginTop = '5px';
        } else {
            player.element.style.height = '40px';
            player.element.style.marginTop = '0px';
        }
    }

    // Update enemy positions with better boundary checking for the larger world
    function updateEnemies() {
        enemies.forEach(enemy => {
            enemy.x += enemy.direction * enemy.speed;
            
            // Better boundary checking for limited patrol areas
            // Each enemy patrols a specific area rather than the entire world
            const patrolDistance = 200;
            const initialX = enemy.initialX || enemy.x;
            
            if (!enemy.initialX) {
                enemy.initialX = enemy.x;
            }
            
            if (enemy.x <= initialX - patrolDistance || enemy.x >= initialX + patrolDistance) {
                enemy.direction *= -1;
            }
            
            enemy.element.style.left = enemy.x + 'px';
            enemy.element.style.top = enemy.y + 'px';
        });
    }

    // Update camera position to follow player
    function updateCamera() {
        // Target position is centered on the player
        game.camera.targetX = player.x - (config.viewportWidth / 2) + (player.width / 2);
        game.camera.targetY = player.y - (config.viewportHeight / 2) + (player.height / 2);
        
        // Camera boundaries
        if (game.camera.targetX < 0) game.camera.targetX = 0;
        if (game.camera.targetX > config.worldWidth - config.viewportWidth) {
            game.camera.targetX = config.worldWidth - config.viewportWidth;
        }
        if (game.camera.targetY < 0) game.camera.targetY = 0;
        if (game.camera.targetY > config.worldHeight - config.viewportHeight) {
            game.camera.targetY = config.worldHeight - config.viewportHeight;
        }
        
        // Smooth camera follow
        game.camera.x += (game.camera.targetX - game.camera.x) * 0.1;
        game.camera.y += (game.camera.targetY - game.camera.y) * 0.1;
        
        // Apply camera position to game area
        document.getElementById('game-world').style.transform = 
            `translate(${-game.camera.x}px, ${-game.camera.y}px)`;
    }

    // Check collisions
    function checkCollisions() {
        // Player with platforms
        let onPlatform = false;
        platforms.forEach(platform => {
            // Improved collision detection
            if (
                player.x < platform.x + platform.width &&
                player.x + player.width > platform.x &&
                player.y + player.height <= platform.y + 5 &&  // Added small threshold
                player.y + player.height + player.velocityY >= platform.y - 5 &&  // Added small threshold
                player.velocityY >= 0  // Only collide when falling down
            ) {
                player.y = platform.y - player.height;
                player.velocityY = 0;
                player.isJumping = false;
                onPlatform = true;
                player.lastOnGround = Date.now(); // Update last time on ground
            }
        });
        
        if (!onPlatform && player.velocityY >= 0) {
            player.isJumping = true;
        }
        
        // Player with coins
        coins.forEach(coin => {
            if (
                !coin.collected &&
                player.x < coin.x + coin.width &&
                player.x + player.width > coin.x &&
                player.y < coin.y + coin.height &&
                player.y + player.height > coin.y
            ) {
                collectCoin(coin);
            }
        });
        
        // Player with enemies
        enemies.forEach(enemy => {
            if (
                player.x < enemy.x + enemy.width &&
                player.x + player.width > enemy.x &&
                player.y < enemy.y + enemy.height &&
                player.y + player.height > enemy.y
            ) {
                hitEnemy();
            }
        });
        
        // Check if player fell off the bottom
        checkWorldBoundaries();
    }
    
    // Check if player fell off the bottom of the world
    function checkWorldBoundaries() {
        if (player.y > config.worldHeight) {
            loseLife();
            resetPlayerPosition();
        }
    }

    // Collect coin
    function collectCoin(coin) {
        coin.collected = true;
        coin.element.style.display = 'none';
        
        // Special coins are worth more points
        if (coin.special) {
            game.score += 50;
        } else {
            game.score += 10;
        }
        
        document.getElementById('score').textContent = game.score;
    }

    // Hit enemy
    function hitEnemy() {
        loseLife();
        resetPlayerPosition();
    }

    // Lose a life
    function loseLife() {
        game.lives--;
        document.getElementById('lives').textContent = game.lives;
        
        if (game.lives <= 0) {
            gameOver();
        }
    }

    // Reset player position
    function resetPlayerPosition() {
        player.x = 150;
        player.y = 1500; // Reset to starting position
        player.velocityX = 0;
        player.velocityY = 0;
    }

    // Game over
    function gameOver() {
        game.isGameOver = true;
        
        // Create game over message
        const gameOverMsg = document.createElement('div');
        gameOverMsg.style.position = 'absolute';
        gameOverMsg.style.top = '50%';
        gameOverMsg.style.left = '50%';
        gameOverMsg.style.transform = 'translate(-50%, -50%)';
        gameOverMsg.style.fontSize = '48px';
        gameOverMsg.style.color = 'white';
        gameOverMsg.style.textShadow = '2px 2px 4px #000';
        gameOverMsg.style.zIndex = '100';
        gameOverMsg.textContent = 'GAME OVER';
        
        const restartMsg = document.createElement('div');
        restartMsg.style.fontSize = '24px';
        restartMsg.style.marginTop = '20px';
        restartMsg.style.textAlign = 'center';
        restartMsg.textContent = 'Refresh the page to play again';
        
        gameOverMsg.appendChild(restartMsg);
        document.getElementById('game').appendChild(gameOverMsg);
    }

    // Game update function
    function update() {
        if (game.isGameOver) return;
        
        // Apply player movement with different air/ground control
        const controlFactor = player.isJumping ? config.airControl : 1;
        
        if (player.isMovingLeft) {
            player.velocityX -= config.playerSpeed * controlFactor;
        }
        if (player.isMovingRight) {
            player.velocityX += config.playerSpeed * controlFactor;
        }
        
        // Apply maximum speed limit
        if (player.velocityX > config.maxSpeed) {
            player.velocityX = config.maxSpeed;
        } else if (player.velocityX < -config.maxSpeed) {
            player.velocityX = -config.maxSpeed;
        }
        
        // Apply physics
        player.velocityX *= config.friction;
        player.velocityY += config.gravity;
        
        // Apply tiny minimum threshold to stop completely
        if (Math.abs(player.velocityX) < 0.1) {
            player.velocityX = 0;
        }
        
        player.x += player.velocityX;
        player.y += player.velocityY;
        
        // Process jump buffer if player just landed
        if (!player.isJumping && player.jumpBuffered) {
            if (Date.now() - player.jumpBufferTimestamp < config.jumpBufferTime) {
                jump();
            }
            player.jumpBuffered = false;
        }
        
        // Boundary checking for the world edges
        if (player.x < 0) {
            player.x = 0;
            player.velocityX = 0;
        }
        if (player.x > config.worldWidth - player.width) {
            player.x = config.worldWidth - player.width;
            player.velocityX = 0;
        }
        
        // Update positions
        updatePlayerPosition();
        updateEnemies();
        
        // Check for collisions
        checkCollisions();
    }

    // Game loop
    function gameLoop() {
        update();
        updateCamera();
        requestAnimationFrame(gameLoop);
    }

    // Start the game when page loads
    window.addEventListener('load', init);
    </script>
</body>
</html>